# Maintainer: Vincent Trumpff <vincent.tr@gmail.com>

pkgname=mylife-home-core-go
pkgver=1.0.4
pkgrel=0
pkgdesc="MyLife Home Core Golang version"
arch="all"
url="http://apps.mti-team2.dyndns.org/"
license="GPL3"
makedepends="go"
source="$pkgname-$pkgver.tar.gz::https://github.com/mylife-home/mylife-home-core-go/archive/refs/tags/v$pkgver.tar.gz https://registry.npmjs.org/mylife-home-core/-/mylife-home-core-${pkgver}.tgz config.yaml mylife-home-core.initd"

check() {
  # TODO: add small check
  /bin/true
}

build() {
  CGO_ENABLED=0 go build -o "$builddir"/mylife-home-core "$srcdir"/mylife-home-core/main.go
}

package() {
  install -dm755 "$pkgdir/etc/mylife-home"
  install -dm755 "$pkgdir/var/log/mylife-home"

  install -m755 -D "$srcdir"/mylife-home-core.initd "$pkgdir"/etc/init.d/mylife-home-core

  cp -pr "$builddir"/mylife-home-core "$pkgdir"/usr/bin/mylife-home-core

  install -m644 -D "$srcdir"/config.yaml "$pkgdir"/etc/mylife-home/config.yaml
}
